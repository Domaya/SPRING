package ncontroller;

import java.sql.SQLException;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.ModelAndView;

import dao.NoticeDao;
import vo.Notice;


@Controller
public class CustomerController {
	private NoticeDao noticsdao;
	@Autowired
	public void setNoticsdao(NoticeDao noticsdao) {
		this.noticsdao = noticsdao;
	}
	
	@RequestMapping("/customer/notice.htm")
	public ModelAndView noticelist(@RequestParam(value="pg", defaultValue = "1") String pg,
			 												  @RequestParam(value ="f", defaultValue = "TITLE") String f,
			 												  @RequestParam(value="p", defaultValue="%%") String p) {
		System.out.println("테스트");
		
		String page = pg;
		String field = f;
		String query = p;

		List<Notice>  list = null;
		
		System.out.println("pg : " + pg + " / f : " + f + " / query : " + p);
		//DAO 작업
		try {
			list = noticsdao.getNotices(Integer.parseInt(page), field, query);
		}catch (Exception e) {
			e.printStackTrace();
		}
		
		ModelAndView   mv = new ModelAndView();
		mv.addObject("list", list);
		mv.setViewName("notice.jsp");
		
		return  mv; //public String searchExternal()   view 주소
	}
	
	@RequestMapping("/customer/noticeDetail.htm")
	public ModelAndView noticeDetail(@RequestParam(value="seq", defaultValue = "") String query) {
		
		System.out.println("param query: " + query);
		String seq = query;
		Notice notice = null;
		try {
			notice = noticsdao.getNotice(seq);
		} catch (Exception e) {
			e.printStackTrace();
		}
		
		ModelAndView  mv = new ModelAndView();
		
		mv.addObject("notice", notice);
		mv.setViewName("noticeDetail.jsp");
		
		
		return mv;
	}
	
}
